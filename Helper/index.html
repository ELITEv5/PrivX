<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PrivX Shield Relay â€” Official Helper v4.0</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
  body{font-family:system-ui,sans-serif;background:#0a0a0a;color:#eee;text-align:center;padding:2rem;max-width:900px;margin:auto}
  h1{color:#8b5cf6;font-size:2rem;margin-bottom:.3rem}
  h3{color:#00ffcc}
  a{color:#8b5cf6;text-decoration:none}
  a:hover{text-decoration:underline;color:#a36fff}
  button{background:#5c00ff;color:#fff;padding:.6rem 1rem;border:none;border-radius:8px;font-size:1rem;cursor:pointer;margin:.3rem;transition:.2s}
  button:hover{background:#6f14ff}
  button:disabled{background:#333;cursor:not-allowed}
  input{width:90%;max-width:420px;margin:.3rem 0;padding:.6rem;border-radius:8px;border:none;font-size:1rem;text-align:center;background:#161616;color:#00ffcc}
  .section{border:1px solid #222;border-radius:12px;padding:1.3rem;margin:1.5rem 0;background:#111}
  #status{margin-bottom:1rem;color:#f55;font-weight:bold}
  footer{margin-top:2rem;font-size:.9rem;color:#777}
  small{color:#aaa;display:block;margin-top:.5rem}
  .warning{color:#ffcc00}
  hr{border:none;border-top:1px solid #333;margin:1.5rem 0}
  .ca-box{background:#161616;padding:0.6rem;border-radius:8px;margin:0.3rem 0;word-break:break-all}
  .ca-copy{background:#333;color:#00ffcc;border:none;border-radius:6px;padding:0.3rem 0.7rem;cursor:pointer;font-size:0.85rem;margin-left:0.4rem;}
  .ca-copy:hover{background:#555;}
  .explainer{background:#141414;border-left:5px solid #8b5cf6;padding:1rem;border-radius:8px;text-align:left;line-height:1.5em;margin-bottom:1.5rem;}
  .hashList{background:#0f0f0f;border-radius:10px;padding:1rem;margin-top:1rem;text-align:left;max-height:200px;overflow-y:auto;}
  .hashItem{margin:0.5rem 0;padding:0.4rem;background:#161616;border-radius:8px;font-size:0.9rem;word-break:break-all;}
  .hashItem button{background:#ff006e;padding:0.3rem 0.8rem;font-size:0.8rem;border-radius:6px;margin-left:0.5rem;}
</style>
</head>
<body>
<h1>ğŸ›¡ï¸ PrivX Shield Relay Helper</h1>
<p><b>Built by Elite Team6 â€¢ Â© Elite Labs â€¢ v4.0</b></p>

<div class="explainer">
  <h3>ğŸŒ Strength in Numbers</h3>
  <p>
    PrivX isnâ€™t about hiding â€” itâ€™s about <b>blending</b>. Every deposit adds to the crowd, making 
    each userâ€™s trail harder to follow. The more who use it, the stronger the shield becomes.
  </p>
  <p><b>We donâ€™t hide. We outnumber.</b></p>
</div>

<!-- ğŸ“œ Official CAs -->
<div class="section" style="background:#141414;">
  <h3>ğŸ“œ Official Contract Addresses</h3>
  <div class="ca-box">
    ğŸ’  PRIVX Token:<br>
    <code id="caToken">0x34310B5d3a8d1e5f8e4A40dcf38E48d90170E986</code>
    <button class="ca-copy" onclick="copyCA('caToken')">Copy</button><br>
    <a href="https://scan.pulsechain.com/address/0x34310B5d3a8d1e5f8e4A40dcf38E48d90170E986" target="_blank">View on PulseChainScan â†—</a>
  </div>
  <div class="ca-box">
    ğŸ›¡ï¸ Shield Relay:<br>
    <code id="caRelay">0xccCFA11f70aBf3d32f38D93FEA4d31D5A99E19dA</code>
    <button class="ca-copy" onclick="copyCA('caRelay')">Copy</button><br>
    <a href="https://scan.pulsechain.com/address/0xccCFA11f70aBf3d32f38D93FEA4d31D5A99E19dA" target="_blank">View on PulseChainScan â†—</a>
  </div>
  <small>âœ… Immutable Contracts â€” No Admin, No Upgrades, 100% On-Chain.</small>
</div>

<!-- ğŸ”’ Vault Tracker -->
<div class="section" id="vaultTracker">
  <h3>ğŸ”’ Shield Vault Tracker</h3>
  <p>Total PRIVX locked in the Shield:</p>
  <h2 id="vaultBalance" style="color:#00ff99;font-weight:bold;">Loading...</h2>
  <small id="vaultUpdate">â³ Fetching...</small>
</div>

<p>Status: <span id="status">Disconnected</span></p>
<button id="connect">ğŸ”— Connect Wallet</button>
<button id="disconnect" style="display:none;background:#333;">ğŸ”Œ Disconnect</button>

<!-- ğŸ’° Deposit -->
<div class="section">
<h3>ğŸ’° Step 1 â€” Deposit PRIVX</h3>
<p>Generate your <b>Secret & Hash</b> using the 
<a href="https://elitev5.github.io/PrivX/Hash-Generator/" target="_blank">official Hash Generator â†—</a>.</p>
<input id="depositAmount" placeholder="Amount (e.g. 10)" /><br/>
<input id="depositHash" placeholder="Secret Hash (0xâ€¦)" /><br/>
<button id="approveBtn">âœ… Approve PRIVX</button>
<button id="depositBtn">ğŸš€ Deposit</button>
</div>

<!-- ğŸ’ Withdraw -->
<div class="section">
<h3>ğŸ’ Step 2 â€” Withdraw</h3>
<p>Use your Secret to withdraw to 1â€“3 wallets within 7 days.</p>
<input id="withdrawSecret" placeholder="Secret (UTF-8 string)" /><br/>
<input id="wallet1" placeholder="Wallet 1 (0xâ€¦)" /><br/>
<input id="wallet2" placeholder="Wallet 2 (optional)" /><br/>
<input id="wallet3" placeholder="Wallet 3 (optional)" /><br/>
<button id="withdrawBtn">ğŸ’ Withdraw</button>
<small class="warning">âš ï¸ Anyone with your Secret can withdraw within 7 days.</small>
</div>

<!-- ğŸ”¥ Reclaim -->
<div class="section">
<h3>ğŸ”¥ Step 3 â€” Reclaim Expired Deposits</h3>
<p>After 7 days, anyone can reclaim unclaimed deposits.</p>
<input id="reclaimHash" placeholder="Deposit Hash (0xâ€¦)" /><br/>
<button id="reclaimBtn">ğŸ”¥ Reclaim</button>
<small>95 % burn ğŸ”¥ â€¢ 5 % reward ğŸ’</small>
</div>

<!-- ğŸ§© NEW: View Reclaimable Deposits -->
<div class="section" id="reclaimViewer" style="background:#161616;">
  <h3>ğŸ§© View All Reclaimable Deposits</h3>
  <p>These are expired deposits that anyone can reclaim for rewards.</p>
  <button id="loadReclaimable">ğŸ” Load Reclaimable Hashes</button>
  <div id="reclaimList" class="hashList">Press the button to load data...</div>
  <small>ğŸ’¡ Refreshes every 30 seconds automatically.</small>
</div>

<footer>
<hr>
<p>PulseChain Native â€¢ MIT License â€¢ Open Source</p>
<p><a href="https://github.com/elitev5/PrivX" target="_blank" rel="noopener noreferrer">View Source on GitHub</a></p>
<p style="margin-top:1rem;color:#8b5cf6;font-weight:bold;">â€œWe donâ€™t hide. We outnumber.â€</p>
</footer>

<script>
async function copyCA(id){
  const text=document.getElementById(id).textContent.trim();
  await navigator.clipboard.writeText(text);
  alert("âœ… Copied:\n"+text);
}

(async ()=>{
 const relayAddress="0xccCFA11f70aBf3d32f38D93FEA4d31D5A99E19dA";
 const tokenAddress="0x34310B5d3a8d1e5f8e4A40dcf38E48d90170E986";
 const PULSECHAIN_ID="0x171";

 let provider,signer,contract,account,privx;
 const abi=await fetch("./abi.json").then(r=>r.json());
 const publicProvider=new ethers.providers.JsonRpcProvider("https://rpc.pulsechain.com");
 const publicContract=new ethers.Contract(relayAddress,abi,publicProvider);

 async function updateVaultBalance(){
   try{
     const balance=await publicContract.totalVaultBalance();
     const human=ethers.utils.formatUnits(balance,18);
     document.getElementById("vaultBalance").textContent=human+" PRIVX";
     document.getElementById("vaultUpdate").textContent="âœ… Updated "+new Date().toLocaleTimeString();
   }catch(e){
     document.getElementById("vaultBalance").textContent="Error fetching balance";
     document.getElementById("vaultUpdate").textContent=e.message;
   }
 }
 setInterval(updateVaultBalance,15000);
 updateVaultBalance();

 async function ensurePulse(){
   const chain=await window.ethereum.request({method:"eth_chainId"});
   if(chain!==PULSECHAIN_ID){
     alert("âš ï¸ Please switch to PulseChain.");
     return false;
   }
   return true;
 }

 async function connect(){
   if(!window.ethereum) return alert("No wallet found. Install MetaMask or Rabby.");
   provider=new ethers.providers.Web3Provider(window.ethereum);
   await provider.send("eth_requestAccounts",[]);
   if(!await ensurePulse())return;
   signer=provider.getSigner();
   account=await signer.getAddress();
   document.getElementById("status").textContent="âœ… Connected: "+account.slice(0,6)+"â€¦"+account.slice(-4);
   document.getElementById("status").style.color="#0f0";
   document.getElementById("disconnect").style.display="inline-block";
   contract=new ethers.Contract(relayAddress,abi,signer);
   privx=new ethers.Contract(tokenAddress,["function approve(address,uint256) external returns (bool)"],signer);
   updateVaultBalance();
 }

 function disconnect(){
   provider=null;signer=null;contract=null;privx=null;account=null;
   document.getElementById("status").textContent="Disconnected";
   document.getElementById("status").style.color="#f55";
   document.getElementById("disconnect").style.display="none";
 }

 async function approve(){
   try{
     const tx=await privx.approve(relayAddress,ethers.constants.MaxUint256);
     alert("âœ… Max approval sent!\n\nTx hash:\n"+tx.hash);
   }catch(e){alert("Approval failed:\n"+e.message);}
 }

 async function deposit(){
   const amt=document.getElementById("depositAmount").value.trim();
   const hash=document.getElementById("depositHash").value.trim();
   if(!amt||!hash)return alert("Enter amount and hash.");
   if(!await ensurePulse())return;
   try{
     const val=ethers.utils.parseUnits(amt,18);
     const tx=await contract.deposit(val,hash);
     alert("âœ… Deposit submitted!\n\nTx hash:\n"+tx.hash);
     updateVaultBalance();
   }catch(e){alert("Deposit failed:\n"+e.message);}
 }

 async function withdraw(){
   const secret=document.getElementById("withdrawSecret").value.trim();
   const addrs=["wallet1","wallet2","wallet3"].map(id=>document.getElementById(id).value.trim()).filter(x=>x&&ethers.utils.isAddress(x));
   if(!secret||addrs.length===0)return alert("Enter Secret and at least one wallet address.");
   if(!await ensurePulse())return;
   try{
     const tx=await contract.withdraw(secret,addrs);
     alert("âœ… Withdraw submitted!\n\nTx hash:\n"+tx.hash);
     updateVaultBalance();
   }catch(e){alert("Withdraw failed:\n"+e.message);}
 }

 async function reclaim(){
   const hash=document.getElementById("reclaimHash").value.trim();
   if(!hash)return alert("Enter deposit hash to reclaim.");
   if(!await ensurePulse())return;
   try{
     const tx=await contract.reclaim(hash);
     alert("âœ… Reclaim submitted!\n\nTx hash:\n"+tx.hash);
     updateVaultBalance();
   }catch(e){alert("Reclaim failed:\n"+e.message);}
 }

 // ğŸ§© Load Reclaimable Deposits
 async function loadReclaimable(){
   const list=document.getElementById("reclaimList");
   list.innerHTML="â³ Loading reclaimable hashes...";
   try{
     const hashes=await publicContract.getReclaimableDeposits();
     if(hashes.length===0){list.innerHTML="âœ… No reclaimable deposits right now.";}
     else{
       list.innerHTML="";
       hashes.forEach(h=>{
         const div=document.createElement("div");
         div.className="hashItem";
         div.innerHTML=`<code>${h}</code> <button onclick="reclaimHashNow('${h}')">ğŸ”¥ Reclaim</button>`;
         list.appendChild(div);
       });
     }
   }catch(e){list.innerHTML="âŒ Error: "+e.message;}
 }
 window.reclaimHashNow=async function(h){
   if(!provider)return alert("Connect your wallet first.");
   if(!await ensurePulse())return;
   try{
     const tx=await contract.reclaim(h);
     alert("ğŸ”¥ Reclaimed!\n\nTx: "+tx.hash);
   }catch(e){alert("Reclaim failed:\n"+e.message);}
 };
 document.getElementById("loadReclaimable").onclick=loadReclaimable;
 setInterval(loadReclaimable,30000);

 async function checkDepositStatus(){
   const hash=document.getElementById("checkHash").value.trim();
   const resultDiv=document.getElementById("checkResult");
   if(!hash)return alert("Enter a deposit hash.");
   try{
     const info=await publicContract.getDeposit(hash);
     const amount=ethers.utils.formatUnits(info.amount,18);
     const date=new Date(info.timestamp*1000).toLocaleString();
     const claimed=info.claimed?"âœ… Claimed":"â³ Unclaimed";
     resultDiv.innerHTML=`Amount: ${amount} PRIVX<br>Deposited: ${date}<br>Status: ${claimed}`;
   }catch(e){
     resultDiv.style.color="#f55";
     resultDiv.textContent="Invalid or not found: "+e.message;
   }
 }

 document.getElementById("connect").onclick=connect;
 document.getElementById("disconnect").onclick=disconnect;
 document.getElementById("approveBtn").onclick=approve;
 document.getElementById("depositBtn").onclick=deposit;
 document.getElementById("withdrawBtn").onclick=withdraw;
 document.getElementById("reclaimBtn").onclick=reclaim;
 document.getElementById("checkBtn").onclick=checkDepositStatus;
})();
</script>
</body>
</html>

