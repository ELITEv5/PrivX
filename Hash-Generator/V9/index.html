<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PrivX Hash Generator â€œCommitâ€“Reveal Editionâ€</title>
<script src="./ethers.umd.min.js"></script>
<style>
  body{font-family:system-ui,sans-serif;background:#0a0a0a;color:#eee;text-align:center;padding:2rem;max-width:820px;margin:auto}
  h1{color:#8b5cf6;text-shadow:0 0 12px #5c00ff;margin-bottom:.5rem}
  h3{color:#00ffcc}
  button{padding:.7rem 1.2rem;background:#5c00ff;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:1rem;margin:.3rem;transition:.2s}
  button:hover{background:#6f14ff}
  input{width:90%;max-width:420px;margin:.4rem 0;padding:.6rem;border-radius:8px;border:none;background:#161616;color:#00ffcc;text-align:center}
  pre{background:#111;color:#00ff99;padding:1rem;border-radius:8px;font-size:.9rem;text-align:left;white-space:pre-wrap;word-break:break-all}
  small{color:#aaa;display:block;margin-top:1rem}
  .instructions{background:#141414;padding:1rem;border-radius:10px;text-align:left;margin-bottom:1.5rem;line-height:1.6em;border-left:5px solid #8b5cf6}
  .section{background:#121212;border-radius:12px;padding:1.5rem;margin:1.5rem 0;border:1px solid #222}
  #unsavedWarning{display:none;background:#ffcc00;color:#000;padding:.8rem;border-radius:8px;margin-bottom:1rem;font-weight:bold}
  #successMessage{display:none;color:#00ff99;font-weight:bold;text-shadow:0 0 10px #00ff99;margin-top:.8rem;animation:glowPulse 2s infinite alternate}
  @keyframes glowPulse{from{text-shadow:0 0 10px #00ff99}to{text-shadow:0 0 20px #00ffcc}}
  /* --- Wallet Creation Guide Styling --- */
.neon-btn {
  background: #5c00ff;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.6rem 1rem;
  margin-top: 0.4rem;
  cursor: pointer;
  font-size: 1rem;
  transition: 0.2s;
  box-shadow: 0 0 10px rgba(91, 0, 255, 0.4);
}
.neon-btn:hover {
  background: #6f14ff;
  box-shadow: 0 0 25px rgba(91, 0, 255, 0.6);
}

.wallet-guide {
  display: none;
  background: #141414;
  border: 1px solid #222;
  border-radius: 10px;
  padding: 1rem;
  margin-top: 0.8rem;
  text-align: left;
  color: #ccc;
  line-height: 1.6em;
  animation: fadeIn 0.4s ease-out;
}
.wallet-guide h4 {
  color: #8b5cf6;
  margin-bottom: 0.6rem;
  text-shadow: 0 0 10px #5c00ff;
}
.wallet-guide li {
  margin: 0.4rem 0;
}

</style>
</head>

<body>
<h1>ğŸ” PrivX Hash Generator â€œCommitâ€“Reveal Editionâ€</h1>
<p>This tool runs 100 % locally in your browser. Nothing ever leaves your device.</p>

<div class="instructions">
  <h3>ğŸ§­ Step-by-Step Guide</h3>
  <ol>
    <li><b>Select your role:</b> Depositor (sender) or Withdrawer (receiver).</li>
    <li>
      <b>Depositor Mode</b> â€” generates a random Secret and Deposit Hash.
      <ul>
        <li>ğŸ§© <b>Secret</b> â€” keep this private. Itâ€™s the key that unlocks your deposit.</li>
        <li>ğŸ’  <b>Deposit Hash</b> â€” used in the main PrivX UI during <b>Deposit</b>.</li>
      </ul>
      The depositor should securely send the <b>Secret</b> to the intended receiver.
    </li>
    <li>
      <b>Withdrawer Mode</b> â€” for the receiver. Enter the shared Secret and your wallet address.
      <ul>
        <li>ğŸ”’ <b>Commit Hash</b> â€” used in the PrivX UI during <b>Commit</b> (Step 2 before withdraw).</li>
      </ul>
      This binds the Secret to your wallet so only you can withdraw.
    </li>
  </ol>
  âš ï¸ <b>ONE-TIME USE ONLY!</b><br>
  Each Secret and its hashes are valid for a single deposit â†’ withdraw cycle.<br>
  Reusing an old Secret or Deposit Hash could let anyone who knows the old Secret steal new funds.
  <p style="color:#00ffcc;">ğŸ’¡ You can save this file and run it offline for maximum privacy.</p>
</div>

<div class="section">
  <h3>âš™ï¸ Select Mode</h3>
  <button id="btnDeposit">ğŸ’  Deposit Mode</button>
  <button id="btnWithdraw">ğŸ”’ Withdraw Mode</button>
  <div id="unsavedWarning">âš ï¸ You have an unsaved Secret or Hash! Copy or save it before generating a new one.</div>
</div>

<div class="section" id="depositSection" style="display:none;">
  <h3>ğŸ’  Deposit Mode</h3>
  <p>Creates a <b>Secret</b> and <b>Deposit Hash</b> for use when locking PRIVX.</p>
  <p>ğŸ’¡ Use the <b>Deposit Hash</b> in the PrivX UI â†’ <b>Step 1: Deposit</b>.</p>
  <button id="generateDeposit">ğŸ§© Generate Secret + Deposit Hash</button>
  <button id="copyDeposit" disabled>ğŸ“‹ Copy All</button>
  <button id="saveDeposit" disabled>ğŸ’¾ Save .txt</button>
  <div id="successMessageDeposit" class="success">âœ… Deposit hashes generated!</div>
  <pre id="outputDeposit">Click â€œGenerateâ€ to create your Secret and Deposit Hash.</pre>
  <small>âš ï¸ Keep your Secret private. Only share it securely with the receiver. Losing it = losing access to funds.</small>
</div>

<div class="section" id="withdrawSection" style="display:none;">
  <h3>ğŸ”’ Withdraw Mode</h3>
  <p>For receivers who were sent a Secret by a depositor.</p>
  <p>Enter that Secret and your wallet to generate a <b>Commit Hash</b>.</p>
  <input id="withdrawSecret" placeholder="Enter Secret (received from depositor)" />
  <input id="walletInput" placeholder="Enter your wallet address (0xâ€¦)" />
  <!-- ğŸª™ Create / Switch Wallet Helper -->
<button id="showWalletGuide" class="neon-btn">ğŸª™ Create / Switch Wallet</button>

<div id="walletGuide" class="wallet-guide">
  <h4>Creating a Fresh Wallet</h4>
  <ol>
    <li>Open your wallet extension (MetaMask, Rabby, Coinbase Wallet, etc.).</li>
    <li>Select <b>â€œAdd Accountâ€</b> or <b>â€œCreate New Walletâ€</b>.</li>
    <li>Copy your new wallet address and paste it above.</li>
    <li>ğŸ’¡ Use a new address for each withdrawal to prevent transaction linkability.</li>
  </ol>
</div>
  <small style="color:#ffcc00;display:block;margin-top:.5rem;">
ğŸ”’ Using a wallet address seen before on-chain may reduce privacy.
Use a fresh wallet to keep deposits and withdrawals unlinkable.
</small>

  <button id="generateWithdraw">ğŸ•¶ï¸ Generate Commit Hash</button>
  <button id="copyWithdraw" disabled>ğŸ“‹ Copy Hash</button>
  <button id="saveWithdraw" disabled>ğŸ’¾ Save .txt</button>
  <div id="successMessageWithdraw" class="success">âœ… Commit Hash generated!</div>
  <pre id="outputWithdraw">Enter your Secret and wallet address, then click â€œGenerate Commit Hashâ€.</pre>
  <small>ğŸ’¡ Use this Commit Hash in the PrivX UI â†’ Step 2: Commit (before withdrawing).</small>
</div>

<script>
let secret="",depositHash="",commitHash="";
const warnBanner=document.getElementById("unsavedWarning");
function showSection(id){
  document.getElementById("depositSection").style.display="none";
  document.getElementById("withdrawSection").style.display="none";
  document.getElementById(id).style.display="block";
}
document.getElementById("btnDeposit").onclick=()=>showSection("depositSection");
document.getElementById("btnWithdraw").onclick=()=>showSection("withdrawSection");

// === Deposit Mode ===
document.getElementById("generateDeposit").onclick=()=>{
  if(typeof ethers==="undefined"){alert("âŒ Ethers.js not loaded.");return;}
  if(secret&&depositHash){if(!confirm("âš ï¸ You already have an unsaved Secret.\nGenerate a new one?"))return;}
  const bytes=crypto.getRandomValues(new Uint8Array(32));
  secret=Array.from(bytes).map(b=>b.toString(16).padStart(2,"0")).join("");
  const abi=new ethers.utils.AbiCoder();
  const encoded=abi.encode(["string"],[secret]);
  depositHash=ethers.utils.keccak256(encoded);
  document.getElementById("outputDeposit").textContent=
`ğŸ§© Secret (keep private, used for withdrawal):
${secret}

ğŸ’  Deposit Hash (for deposit):
${depositHash}

âš ï¸ Save this Secret securely and send it privately to the receiver.
Use the Deposit Hash in the main PrivX UI â†’ Step 1 â€œDepositâ€.`;
  document.getElementById("copyDeposit").disabled=false;
  document.getElementById("saveDeposit").disabled=false;
  warnBanner.style.display="block";
};
document.getElementById("copyDeposit").onclick=async()=>{
  const text=`Secret:\n${secret}\n\nDeposit Hash:\n${depositHash}`;
  await navigator.clipboard.writeText(text);
  alert("âœ… Deposit values copied to clipboard");
  warnBanner.style.display="none";
};
document.getElementById("saveDeposit").onclick=()=>{
  const content=`PrivX V9 â€” Deposit Mode Output

Secret (keep private):
${secret}

Deposit Hash (for deposit):
${depositHash}

âš ï¸ Share only the Secret with the receiver.
Deposit Hash is used on-chain in PrivX UI Step 1 (Deposit).`;
  const blob=new Blob([content],{type:"text/plain"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="PrivX-V9-deposit-hashes.txt";
  link.click();
  warnBanner.style.display="none";
};

// === Withdraw Mode ===
document.getElementById("generateWithdraw").onclick=()=>{
  if(typeof ethers==="undefined"){alert("âŒ Ethers.js not loaded.");return;}
  const s=document.getElementById("withdrawSecret").value.trim();
  const w=document.getElementById("walletInput").value.trim();
  if(!s){alert("âš ï¸ Enter the Secret you received from the depositor.");return;}
  if(!ethers.utils.isAddress(w)){alert("âš ï¸ Enter a valid wallet address (0xâ€¦).");return;}
  const packed=ethers.utils.solidityPack(["string","address"],[s,w]);
  commitHash=ethers.utils.keccak256(packed);
  document.getElementById("outputWithdraw").textContent=
`ğŸ”’ Commit Hash (for commit before withdraw):
${commitHash}

ğŸ’¡ Use this hash in the PrivX UI â†’ Step 2 â€œCommitâ€ with your wallet connected.
This binds the Secret to your wallet and enables stealth withdrawal.`;
  document.getElementById("copyWithdraw").disabled=false;
  document.getElementById("saveWithdraw").disabled=false;
  warnBanner.style.display="block";
};
document.getElementById("copyWithdraw").onclick=async()=>{
  const text=`Commit Hash (for commit before withdraw):\n${commitHash}`;
  await navigator.clipboard.writeText(text);
  alert("âœ… Commit hash copied to clipboard");
  warnBanner.style.display="none";
};
document.getElementById("saveWithdraw").onclick=()=>{
  const content=`PrivX V9 â€” Withdraw Mode Output

Commit Hash (for commit before withdraw):
${commitHash}

âš™ï¸ Use this hash in PrivX UI â†’ Step 2 (Commit) from your wallet.
It binds the Secret to your address and activates stealth protection.`;
  const blob=new Blob([content],{type:"text/plain"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="PrivX-V9-commit-hash.txt";
  link.click();
  warnBanner.style.display="none";
};
  // ğŸª™ Toggle wallet creation instructions
document.getElementById("showWalletGuide").onclick = () => {
  const guide = document.getElementById("walletGuide");
  guide.style.display = guide.style.display === "block" ? "none" : "block";
};

</script>

<footer style="margin-top:2rem;font-size:.85rem;color:#777;text-align:center;">
  <hr style="border:none;border-top:1px solid #333;margin:1.5rem 0;">
  <p>V9 Commitâ€“Reveal Edition â€¢ Built by <b>Elite Team6</b> â€¢ Â© Elite Labs 2025<br>
  <a href="https://github.com/elitev5/PrivX" target="_blank" style="color:#8b5cf6;">View on GitHub</a></p>
</footer>
</body>
</html>





