<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PrivX Hash Generator â€” V9 â€œCommitâ€“Reveal Editionâ€</title>
<script src="./ethers.umd.min.js"></script>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #0a0a0a;
    color: #eee;
    text-align: center;
    padding: 2rem;
    max-width: 820px;
    margin: 0 auto;
  }
  h1 {
    color: #8b5cf6;
    text-shadow: 0 0 12px #5c00ff;
    margin-bottom: 0.5rem;
  }
  h3 { color: #00ffcc; }
  button {
    padding: 0.7rem 1.2rem;
    background: #5c00ff;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    margin: 0.3rem;
    transition: 0.2s;
  }
  button:hover { background: #6f14ff; }
  input {
    width: 90%;
    max-width: 420px;
    margin: 0.4rem 0;
    padding: 0.6rem;
    border-radius: 8px;
    border: none;
    background: #161616;
    color: #00ffcc;
    text-align: center;
  }
  pre {
    background: #111;
    color: #00ff99;
    padding: 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    text-align: left;
    white-space: pre-wrap;
    word-break: break-all;
  }
  small { color: #aaa; display: block; margin-top: 1rem; }
  .instructions {
    background: #141414;
    padding: 1rem;
    border-radius: 10px;
    text-align: left;
    margin-bottom: 1.5rem;
    line-height: 1.6em;
    border-left: 5px solid #8b5cf6;
  }
  .section {
    background: #121212;
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    border: 1px solid #222;
  }
  #unsavedWarning {
    display: none;
    background: #ffcc00;
    color: #000;
    padding: 0.8rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    font-weight: bold;
  }
  #successMessage {
    display: none;
    color: #00ff99;
    font-weight: bold;
    text-shadow: 0 0 10px #00ff99;
    margin-top: 0.8rem;
    animation: glowPulse 2s infinite alternate;
  }
  @keyframes glowPulse {
    from { text-shadow: 0 0 10px #00ff99; }
    to { text-shadow: 0 0 20px #00ffcc; }
  }
</style>
</head>

<body>
<h1>ğŸ” PrivX Hash Generator â€” V9 â€œCommitâ€“Reveal Editionâ€</h1>
<p>This tool runs 100 % locally in your browser. Nothing ever leaves your device.</p>

<div class="instructions">
  <h3>ğŸ§­ How to Use</h3>
  <ul>
    <li>Use <b>Deposit Mode</b> to create a new <b>Secret</b> and <b>Deposit Hash</b> for sending PRIVX.</li>
    <li>Send the <b>Secret</b> securely (off-chain) to your receiver. Never post it publicly.</li>
    <li>The receiver will use <b>Withdraw Mode</b> to generate a <b>Commit Hash</b> for their wallet, then use it in the official UI to withdraw.</li>
  </ul>
  <p style="color:#00ffcc;">ğŸ’¡ You can save this file and run it offline for maximum privacy.</p>
</div>

<div class="section">
  <h3>âš™ï¸ Select Mode</h3>
  <button id="btnDeposit">ğŸ’  Deposit Mode</button>
  <button id="btnWithdraw">ğŸ”’ Withdraw Mode</button>
  <div id="unsavedWarning">âš ï¸ You have an unsaved Secret or Hash! Copy or save it before generating a new one.</div>
</div>

<div class="section" id="depositSection" style="display:none;">
  <h3>ğŸ’  Deposit Mode</h3>
  <p>Generates a <b>Secret</b> and <b>Deposit Hash</b> for the depositor.<br>Use the Deposit Hash in the main PrivX UI when calling <code>deposit()</code>.</p>
  <button id="generateDeposit">ğŸ§© Generate Secret + Deposit Hash</button>
  <button id="copyDeposit" disabled>ğŸ“‹ Copy All</button>
  <button id="saveDeposit" disabled>ğŸ’¾ Save .txt</button>
  <div id="successMessageDeposit" class="success">âœ… Deposit hashes generated!</div>
  <pre id="outputDeposit">Click â€œGenerateâ€ to create your Secret and Deposit Hash.</pre>
  <small>âš ï¸ Keep your Secret private. Only share the Deposit Hash with the receiver.</small>
</div>

<div class="section" id="withdrawSection" style="display:none;">
  <h3>ğŸ”’ Withdraw Mode</h3>
  <p>Enter your <b>Secret</b> (from the depositor) and your <b>wallet address</b>.<br>This creates a <b>Commit Hash</b> to use in the UIâ€™s <code>commit()</code> step before withdrawing.</p>
  <input id="withdrawSecret" placeholder="Enter the secret (from depositor)" />
  <input id="walletInput" placeholder="Enter your withdraw wallet (0xâ€¦)" />
  <button id="generateWithdraw">ğŸ•¶ï¸ Generate Commit Hash</button>
  <button id="copyWithdraw" disabled>ğŸ“‹ Copy Hash</button>
  <button id="saveWithdraw" disabled>ğŸ’¾ Save .txt</button>
  <div id="successMessageWithdraw" class="success">âœ… Commit Hash generated!</div>
  <pre id="outputWithdraw">Enter your Secret and Wallet, then click â€œGenerate Commit Hashâ€.</pre>
  <small>ğŸ’¡ Use this Commit Hash in the PrivX UI â†’ Step 2: Commit before withdrawing.</small>
</div>

<script>
let secret="",depositHash="",commitHash="";
const warnBanner=document.getElementById("unsavedWarning");

function showSection(id){
  document.getElementById("depositSection").style.display="none";
  document.getElementById("withdrawSection").style.display="none";
  document.getElementById(id).style.display="block";
}

document.getElementById("btnDeposit").onclick=()=>showSection("depositSection");
document.getElementById("btnWithdraw").onclick=()=>showSection("withdrawSection");

// === Deposit Mode ===
document.getElementById("generateDeposit").onclick=()=>{
  if(typeof ethers==="undefined"){alert("âŒ Ethers.js not loaded.");return;}
  const bytes=crypto.getRandomValues(new Uint8Array(32));
  secret=Array.from(bytes).map(b=>b.toString(16).padStart(2,"0")).join("");
  const abi=new ethers.utils.AbiCoder();
  const encoded=abi.encode(["string"],[secret]);
  depositHash=ethers.utils.keccak256(encoded);
  document.getElementById("outputDeposit").textContent=
`ğŸ§© Secret (keep private, used for withdrawal):
${secret}

ğŸ’  Deposit Hash (for deposit):
${depositHash}

âš ï¸ Save this Secret securely and send it privately to the receiver.
Use the Deposit Hash in the main PrivX UI during the deposit step.`;
  document.getElementById("copyDeposit").disabled=false;
  document.getElementById("saveDeposit").disabled=false;
  warnBanner.style.display="block";
};

document.getElementById("copyDeposit").onclick=async()=>{
  const text=`Secret:\n${secret}\n\nDeposit Hash:\n${depositHash}`;
  await navigator.clipboard.writeText(text);
  alert("âœ… Deposit values copied to clipboard");
  warnBanner.style.display="none";
};

document.getElementById("saveDeposit").onclick=()=>{
  const content=`PrivX V9 â€” Deposit Mode Output

Secret (keep private):
${secret}

Deposit Hash (for deposit):
${depositHash}

âš ï¸ Share only the Secret with the intended receiver.
Deposit Hash is used on-chain in the PrivX UI when calling deposit().`;
  const blob=new Blob([content],{type:"text/plain"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="PrivX-V9-deposit-hashes.txt";
  link.click();
  warnBanner.style.display="none";
};

// === Withdraw Mode ===
document.getElementById("generateWithdraw").onclick=()=>{
  if(typeof ethers==="undefined"){alert("âŒ Ethers.js not loaded.");return;}
  const secret=document.getElementById("withdrawSecret").value.trim();
  const wallet=document.getElementById("walletInput").value.trim();
  if(!secret){alert("âš ï¸ Enter the Secret you received from the depositor.");return;}
  if(!ethers.utils.isAddress(wallet)){alert("âš ï¸ Enter a valid wallet address (0xâ€¦).");return;}
  const packed=ethers.utils.solidityPack(["string","address"],[secret,wallet]);
  commitHash=ethers.utils.keccak256(packed);
  document.getElementById("outputWithdraw").textContent=
`ğŸ”’ Commit Hash (for commit before withdraw):
${commitHash}

ğŸ’¡ Use this hash in the main PrivX UI (Step 2: Commit) with your wallet connected.
This binds the secret to your wallet and activates stealth protection.`;
  document.getElementById("copyWithdraw").disabled=false;
  document.getElementById("saveWithdraw").disabled=false;
  warnBanner.style.display="block";
};

document.getElementById("copyWithdraw").onclick=async()=>{
  const text=`Commit Hash (for commit before withdraw):\n${commitHash}`;
  await navigator.clipboard.writeText(text);
  alert("âœ… Commit hash copied to clipboard");
  warnBanner.style.display="none";
};

document.getElementById("saveWithdraw").onclick=()=>{
  const content=`PrivX V9 â€” Withdraw Mode Output

Commit Hash (for commit before withdraw):
${commitHash}

âš™ï¸ Use this hash in the PrivX UI â†’ Step 2: Commit, from your connected wallet.
This binds the secret to your wallet address for secure withdrawal.`;
  const blob=new Blob([content],{type:"text/plain"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="PrivX-V9-commit-hash.txt";
  link.click();
  warnBanner.style.display="none";
};
</script>

<footer style="margin-top:2rem;font-size:0.85rem;color:#777;text-align:center;">
  <hr style="border:none;border-top:1px solid #333;margin:1.5rem 0;">
  <p>V9 Commitâ€“Reveal Edition â€¢ Built by <b>Elite Team6</b> â€¢ Â© Elite Labs 2025<br>
  <a href="https://github.com/elitev5/PrivX" target="_blank" style="color:#8b5cf6;">View on GitHub</a></p>
</footer>
</body>
</html>




