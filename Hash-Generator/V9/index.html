<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PrivX Hash Generator â€” V9 Commitâ€“Reveal Edition</title>
<script src="./ethers.umd.min.js"></script>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #0a0a0a;
    color: #eee;
    text-align: center;
    padding: 2rem;
    max-width: 820px;
    margin: 0 auto;
  }
  h1 {
    color: #8b5cf6;
    text-shadow: 0 0 12px #5c00ff;
    margin-bottom: 0.5rem;
  }
  h3 { color: #00ffcc; }
  button {
    padding: 0.7rem 1.2rem;
    background: #5c00ff;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    margin: 0.3rem;
    transition: 0.2s;
  }
  button:hover { background: #6f14ff; }
  input {
    width: 90%;
    max-width: 420px;
    margin: 0.4rem 0;
    padding: 0.6rem;
    border-radius: 8px;
    border: none;
    background: #161616;
    color: #00ffcc;
    text-align: center;
  }
  pre {
    background: #111;
    color: #00ff99;
    padding: 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    text-align: left;
    white-space: pre-wrap;
    word-break: break-all;
  }
  small { color: #aaa; display: block; margin-top: 1rem; }
  .instructions {
    background: #141414;
    padding: 1rem;
    border-radius: 10px;
    text-align: left;
    margin-bottom: 1.5rem;
    line-height: 1.6em;
    border-left: 5px solid #8b5cf6;
  }
  .section {
    background: #121212;
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    border: 1px solid #222;
  }
  #unsavedWarning {
    display: none;
    background: #ffcc00;
    color: #000;
    padding: 0.8rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    font-weight: bold;
  }
  #advanced {
    background: #0f0f0f;
    border-radius: 10px;
    padding: 1rem;
    margin-top: 1rem;
    text-align: left;
    display: none;
  }
  #advanced p, #advanced li { font-size: 0.9rem; line-height: 1.5em; }
</style>
</head>

<body>
<h1>ğŸ” PrivX Hash Generator â€” V9 â€œCommitâ€“Reveal Editionâ€</h1>
<p>This tool runs 100% locally in your browser. No wallet connection required. No data leaves your device.</p>

<div class="instructions">
  <h3>ğŸ§­ Step-by-Step Guide</h3>
  <ol>
    <li>Enter your <b>wallet address</b> (used for your unique commit hash).</li>
    <li>Click <b>Generate</b> â€” this creates:
      <ul>
        <li>ğŸ§© <b>Secret</b> â€” private string used for withdrawal.</li>
        <li>ğŸ’  <b>Deposit Hash</b> â€” used in the deposit step.</li>
        <li>ğŸ”’ <b>Commit Hash</b> â€” used before withdrawing.</li>
      </ul>
    </li>
    <li>Copy or save your results securely. <b>Losing your Secret = losing your funds.</b></li>
  </ol>
</div>

<div class="section">
  <input id="walletInput" placeholder="Enter your wallet address (0xâ€¦)" />
  <div id="unsavedWarning">âš ï¸ You have an unsaved Secret! Copy or save it before generating a new one.</div>

  <button id="generate">ğŸ§© Generate Secret + Hashes</button>
  <button id="copyAll" disabled>ğŸ“‹ Copy All</button>
  <button id="saveTxt" disabled>ğŸ’¾ Save .txt</button>

  <pre id="output">Click â€œGenerateâ€ to create your secret, deposit hash, and commit hash.</pre>
  <small>ğŸ’¡ The Secret is private â€” only Deposit and Commit hashes are safe to share.</small>
</div>

<p><a href="#" id="toggleAdvanced">ğŸ“˜ Show Advanced Explanation</a></p>

<div id="advanced">
  <h3>ğŸ” Understanding the Commitâ€“Reveal Process</h3>
  <p>The Shield Relay V9 uses a two-step privacy mechanism to defeat front-running:</p>
  <ol>
    <li><b>Deposit</b> â€” You lock tokens with a hash of your Secret (<code>keccak256(secret)</code>).</li>
    <li><b>Commit</b> â€” You pre-register a hash tied to your address (<code>keccak256(secret + address)</code>).</li>
    <li><b>Withdraw</b> â€” You reveal your Secret, the contract checks your commit, and releases funds.</li>
  </ol>
  <p>Even if two people choose the same secret, their commit hashes are unique because they depend on wallet addresses.  
     This makes linking deposits and withdrawals statistically impossible.</p>
</div>

<script>
let secret = "", depositHash = "", commitHash = "";
const warnBanner = document.getElementById("unsavedWarning");

document.getElementById("toggleAdvanced").onclick = (e)=>{
  e.preventDefault();
  const adv = document.getElementById("advanced");
  adv.style.display = adv.style.display === "block" ? "none" : "block";
};

document.getElementById("generate").onclick = async () => {
  const wallet = document.getElementById("walletInput").value.trim();
  if (!ethers.utils.isAddress(wallet)) {
    alert("âŒ Please enter a valid wallet address (0x...)");
    return;
  }

  if (secret && depositHash) {
    if (!confirm("âš ï¸ You already have an unsaved Secret.\nGenerate a new one?")) return;
  }

  // Generate random secret
  const bytes = crypto.getRandomValues(new Uint8Array(32));
  secret = Array.from(bytes).map(b => b.toString(16).padStart(2, "0")).join("");

  // Compute hashes
  const abiCoder = new ethers.utils.AbiCoder();
  const encoded = abiCoder.encode(["string"], [secret]);
  depositHash = ethers.utils.keccak256(encoded);

  const packed = ethers.utils.solidityPack(["string", "address"], [secret, wallet]);
  commitHash = ethers.utils.keccak256(packed);

  // Display
  document.getElementById("output").textContent =
`ğŸ§© Secret (for withdrawal):
${secret}

ğŸ’  Deposit Hash (for deposit):
${depositHash}

ğŸ”’ Commit Hash (for commit before withdraw):
${commitHash}

âš ï¸ Keep your Secret private. The Deposit and Commit hashes are safe to share when needed.`;

  document.getElementById("copyAll").disabled = false;
  document.getElementById("saveTxt").disabled = false;
  warnBanner.style.display = "block";
};

document.getElementById("copyAll").onclick = async ()=>{
  const text = `Secret:\n${secret}\n\nDeposit Hash:\n${depositHash}\n\nCommit Hash:\n${commitHash}`;
  await navigator.clipboard.writeText(text);
  alert("âœ… All values copied to clipboard");
  warnBanner.style.display = "none";
};

document.getElementById("saveTxt").onclick = ()=>{
  const content =
`PrivX V9 Commitâ€“Reveal Generator Output

Secret (keep private):
${secret}

Deposit Hash (for deposit):
${depositHash}

Commit Hash (for commit before withdraw):
${commitHash}

âš ï¸ Share only the Secret with trusted recipients within 7 days.
After 7 days, funds become reclaimable (95% burn / 5% reward).`;

  const blob = new Blob([content], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "PrivX-V9-secret-commit.txt";
  link.click();
  warnBanner.style.display = "none";
};
</script>

<footer style="margin-top:2rem;font-size:0.85rem;color:#777;text-align:center;">
  <hr style="border:none;border-top:1px solid #333;margin:1.5rem 0;">
  <p>
    V9 Commitâ€“Reveal Edition â€¢ Last updated: Nov 2025<br>
    Built by <b>Elite Team6</b> â€¢ Â© Elite Labs 2025<br>
    <a href="https://github.com/elitev5/PrivX" target="_blank" style="color:#8b5cf6;">View on GitHub</a>
  </p>
</footer>
</body>
</html>

