<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrivX Hurricane â€“ Privacy That Pays</title>
  <link rel="icon" href="privx-shield.png" type="image/png">
  <meta property="og:image" content="https://github.com/ELITEv5/PrivX/Hurricane/privx-shield.png">
  <meta property="og:type" content="website">
  <meta name="robots" content="index,follow">
  <meta name="description" content="The world's first fully on-chain, ownerless, immutable privacy protocol. Instant 2% Proof-of-Privacy rewards.">
  <meta property="og:title" content="PrivX Hurricane â€“ Privacy That Pays">
  <meta property="og:description" content="Anonymous PRIVX transfers + instant 1-2% rewards. ELITE Team6 â€“ November 7, 2025">
  <meta name="theme-color" content="#8A2BE2">
  <style>
    /* Your existing styles â€“ unchanged */
    :root {
      --primary: #8A2BE2;
      --accent: #00ffea;
      --bg: #000;
      --card: rgba(138,43,226,0.15);
      --glow: rgba(138,43,226,0.6);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',sans-serif;background:var(--bg);color:#fff;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;overflow-x:hidden}
    canvas#matrix-bg{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
    .container{background:rgba(10,10,10,0.7);backdrop-filter:blur(20px);border-radius:24px;padding:40px 30px;max-width:620px;width:100%;border:1px solid var(--primary);box-shadow:0 0 80px var(--glow),inset 0 0 40px rgba(138,43,226,0.1);position:relative;z-index:10}
    h1{font-size:3.2em;background:linear-gradient(90deg,var(--primary),var(--accent));-webkit-background-clip:text;color:transparent;margin-bottom:8px;text-shadow:0 0 30px var(--glow)}
    .subtitle{color:var(--accent);font-size:1.4em;margin-bottom:30px}
    .wallet-button{position:fixed;top:20px;right:20px;background:rgba(10,10,10,0.8);backdrop-filter:blur(10px);padding:12px 28px;border:2px solid var(--primary);border-radius:12px;color:#fff;font-weight:600;cursor:pointer;transition:all .3s;z-index:9999}
    .wallet-button:hover{border-color:var(--accent);box-shadow:0 0 30px var(--glow)}
    .wallet-button.connected{color:var(--accent);border-color:var(--accent);box-shadow:0 0 30px var(--glow)}
    .tabs{display:flex;gap:12px;margin-bottom:30px}
    .tab{flex:1;padding:14px;border:2px solid rgba(255,255,255,0.1);border-radius:12px;background:rgba(20,20,20,0.6);cursor:pointer;transition:all .3s;text-align:center;font-weight:600}
    .tab:hover{border-color:var(--primary)}
    .tab.active{background:var(--primary);color:#fff;border-color:var(--primary);box-shadow:0 0 30px var(--glow)}
    .denomination-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin:30px 0}
    .denomination-card{background:var(--card);border:2px solid transparent;border-radius:16px;padding:24px;cursor:pointer;transition:all .4s;text-align:center}
    .denomination-card:hover{border-color:var(--primary);transform:translateY(-6px);box-shadow:0 12px 40px rgba(138,43,226,0.4)}
    .denomination-card.selected{border:3px solid var(--primary);background:rgba(138,43,226,0.3);box-shadow:0 0 50px var(--glow);transform:scale(1.04)}
    .denomination-amount{font-size:26px;font-weight:900;display:flex;align-items:center;justify-content:center;gap:12px;color:#fff}
    .denomination-amount img{height:36px;width:36px;border-radius:50%;box-shadow:0 0 20px var(--glow)}
    .denomination-label{margin-top:8px;color:#aaa;font-size:13px}
    .button{width:100%;padding:18px;background:var(--primary);color:#fff;border:none;border-radius:14px;font-size:18px;font-weight:700;cursor:pointer;margin-top:20px;transition:all .3s;box-shadow:0 0 30px var(--glow)}
    .button:hover{background:var(--accent);color:#000;transform:translateY(-3px)}
    .button:disabled{background:#333;color:#666;cursor:not-allowed}
    .note-display{background:#111;border:2px solid var(--primary);padding:20px;border-radius:14px;margin-top:25px;font-family:monospace;color:var(--accent);box-shadow:0 0 30px var(--glow)}
    .stats-list{background:rgba(20,20,20,0.6);border-radius:14px;padding:20px;margin-top:30px;border:1px solid rgba(138,43,226,0.3)}
    .stat-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.05)}
    .stat-row:last-child{border:none}
    .stat-denomination{font-weight:700;color:#fff}
    .stat-balance{color:var(--accent);font-weight:700}
    .vault-display{margin-top:30px;padding:20px;background:rgba(138,43,226,0.2);border-radius:14px;text-align:center;border:1px solid var(--primary)}
    .vault-display span{color:var(--accent);font-size:1.4em;font-weight:900}
    .hidden { display: none !important; }
    .logo-header { text-align: center; margin-bottom: 30px; }
    .privx-logo { max-width: 340px; width: 100%; height: auto; margin: 0 auto 12px auto; display: block; filter: drop-shadow(0 0 25px var(--glow)); transition: transform 0.3s ease, filter 0.3s ease; }
    .privx-logo:hover { transform: scale(1.07); filter: drop-shadow(0 0 40px var(--accent)); }
    @media (max-width: 768px) { .privx-logo { max-width: 260px; } }
    @media (max-width: 480px) { .privx-logo { max-width: 200px; } }
    @media (max-width: 768px) {
      h1 { font-size: 2.2em; text-align:center; }
      .subtitle { font-size:1.1em; text-align:center; }
      .container { max-width:95%; padding:24px 18px; }
      .wallet-button { top:10px; right:10px; padding:10px 16px; font-size:14px; }
      .denomination-grid { grid-template-columns:1fr; gap:14px; }
      .denomination-amount { font-size:22px; }
      .button { padding:14px; font-size:16px; }
      .note-display { font-size:14px; word-break:break-all; }
    }
    @media (max-width: 480px) {
      body { align-items:flex-start; padding-top:40px; }
      h1 { font-size:1.8em; }
    }
    .loading { opacity: 0.6; pointer-events: none; }
  </style>
</head>
<body>
  <canvas id="matrix-bg"></canvas>
  <div id="walletButton" class="wallet-button" onclick="toggleWallet()">
    <span id="walletButtonText">Connect Wallet</span>
  </div>
  <div class="container">
    <div class="logo-header">
      <img src="privx_logo.png" alt="PrivX Hurricane" class="privx-logo">
      <p class="subtitle">Hurricane Shield + Instant 1-2% Proof-of-Privacy Rewards</p>
    </div>
    <div class="tabs">
      <div class="tab active" onclick="switchTab('deposit')">Deposit</div>
      <div class="tab" onclick="switchTab('withdraw')">Withdraw</div>
    </div>
    <div id="depositTab">
      <div class="denomination-grid">
        <div class="denomination-card" onclick="selectDenomination('100')">
          <div class="denomination-amount">100 PRIVX <img src="privx-shield.png" alt="PrivX"></div>
          <div class="denomination-label">Instant 2% reward</div>
        </div>
        <div class="denomination-card" onclick="selectDenomination('1000')">
          <div class="denomination-amount">1,000 PRIVX <img src="privx-shield.png" alt="PrivX"></div>
          <div class="denomination-label">Instant 2% reward</div>
        </div>
        <div class="denomination-card" onclick="selectDenomination('10000')">
          <div class="denomination-amount">10,000 PRIVX <img src="privx-shield.png" alt="PrivX"></div>
          <div class="denomination-label">Instant 2% reward</div>
        </div>
        <div class="denomination-card" onclick="selectDenomination('100000')">
          <div class="denomination-amount">100,000 PRIVX <img src="privx-shield.png" alt="PrivX"></div>
          <div class="denomination-label">Instant 2% reward</div>
        </div>
      </div>
      <button class="button" id="depositBtn" disabled>Select Denomination</button>
      <div id="depositNote" class="note-display hidden">
        <strong>YOUR PRIVATE NOTE â€“ SAVE THIS SECURELY!</strong><br><br>
        <span id="noteText"></span><br><br>
        <button class="button" onclick="copyNote()" style="padding:12px 24px;font-size:15px;width:auto">Copy Note</button>
      </div>
    </div>
    <div id="withdrawTab" class="hidden">
      <input type="text" id="withdrawNote" placeholder="Paste your private note here" style="width:100%;padding:16px;margin:15px 0;border-radius:12px;border:1px solid #444;background:#111;color:#fff;font-family:monospace">
      <input type="text" id="recipientAddress" placeholder="Recipient address (optional â€“ defaults to connected wallet)" style="width:100%;padding:16px;margin:15px 0;border-radius:12px;border:1px solid #444;background:#111;color:#fff">
      <button class="button" onclick="withdraw()">Generate Proof + Withdraw</button>
    </div>
    <div class="vault-display">
      <div>Proof-of-Privacy Mining Vault</div>
      <span id="vaultBalance">Loading...</span> PRIVX Available
    </div>
    <div class="vault-display">
      <div>ðŸ”¥ Total PRIVX Burned</div>
      <span id="burnedBalance">Loading...</span> PRIVX
    </div>
    <div class="stats-list" id="statsContainer"></div>
  </div>

  <!-- CDNs for browser ZK libs -->
  <script src="https://cdn.jsdelivr.net/npm/snarkjs@latest/build/snarkjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/circomlibjs@latest/build/circomlibjs.js"></script>
  <script src="./web3.min.js"></script>

  <script type="module">
    const ZKEY_URL = "https://gateway.pinata.cloud/ipfs/bafybeigk4mdkbngi7t72tdxnlpcfhynbgb3wbofitl7yuj7n4ddxsivvea";
    const WASM_URL = "./circuits/mixer_js/mixer.wasm"; // Place this file in your public repo root or /circuits/mixer_js/

    const SHIELDS = {
      "100": "0x1746f6fe7447A13B7554fAb9FA0b77A8a5A61821",
      "1000": "0x0F15B28f1B9C9b3c4B7b9d7864ef79BeEBCb37b6",
      "10000": "0x8c17b741695Cb4B7c81F8Bfc20203B47dcd8d285",
      "100000": "0x4b393d5Bef35E225074Ed1f247D147F8c9e904F4"
    };

    let web3, userAccount, selectedDenomination;

    // Wallet connection (PulseChain auto-switch)
    window.toggleWallet = async function() {
      if (!window.ethereum) return alert("No wallet detected â€“ install MetaMask");
      try {
        await window.ethereum.request({ method: "eth_requestAccounts" });
        try {
          await window.ethereum.request({ method: "wallet_switchEthereumChain", params: [{ chainId: "0x171" }] });
        } catch (e) {
          if (e.code === 4902) {
            await window.ethereum.request({
              method: "wallet_addEthereumChain",
              params: [{
                chainId: "0x171",
                chainName: "PulseChain",
                rpcUrls: ["https://rpc.pulsechain.com"],
                nativeCurrency: { name: "PLS", symbol: "PLS", decimals: 18 },
                blockExplorerUrls: ["https://scan.pulsechain.com"]
              }]
            });
          }
        }
        web3 = new Web3(window.ethereum);
        const accounts = await web3.eth.getAccounts();
        userAccount = accounts[0];
        document.getElementById("walletButtonText").textContent = `${userAccount.slice(0,6)}...${userAccount.slice(-4)}`;
        document.getElementById("walletButton").classList.add("connected");
        updateDepositButton();
      } catch (err) {
        alert("Wallet connection failed");
      }
    };

    // Auto-connect
    if (window.ethereum) {
      window.ethereum.request({ method: "eth_accounts" }).then(accs => accs.length > 0 && toggleWallet());
    }

    // Denomination selection
    window.selectDenomination = function(denom) {
      selectedDenomination = denom;
      document.querySelectorAll('.denomination-card').forEach(c => c.classList.remove('selected'));
      event.target.closest('.denomination-card').classList.add('selected');
      updateDepositButton();
    };

    function updateDepositButton() {
      const btn = document.getElementById('depositBtn');
      if (!userAccount) {
        btn.textContent = "Connect Wallet First";
        btn.disabled = true;
      } else if (!selectedDenomination) {
        btn.textContent = "Select Denomination";
        btn.disabled = true;
      } else {
        btn.textContent = `Shield ${selectedDenomination} PRIVX + Get Note`;
        btn.disabled = false;
      }
    }

    // Deposit: Generate commitment + note (browser Poseidon)
    window.deposit = async function() {
      if (!userAccount || !selectedDenomination) return;
      const btn = document.getElementById('depositBtn');
      btn.disabled = true;
      btn.textContent = "Generating Commitment...";
      try {
        const poseidon = await circomlibjs.buildPoseidon();
        const nullifier = crypto.getRandomValues(new Uint8Array(31));
        const secret = crypto.getRandomValues(new Uint8Array(31));
        const nullifierHash = poseidon([BigInt("0x" + Buffer.from(nullifier).toString("hex"))]); // adjust if needed
        const commitment = poseidon([nullifierHash, BigInt(userAccount), BigInt("0x" + Buffer.from(secret).toString("hex"))]);

        const note = `privx-${selectedDenomination}-${Buffer.from(nullifier).toString('hex')}-${Buffer.from(secret).toString('hex')}`;
        document.getElementById('noteText').textContent = note;
        document.getElementById('depositNote').classList.remove('hidden');

        // TODO: Approve PRIVX + call deposit(commitment) on-chain here
        alert("Commitment generated! Save your note. On-chain deposit coming soon.");
      } catch (e) {
        console.error(e);
        alert("Commitment generation failed");
      } finally {
        btn.disabled = false;
        btn.textContent = `Shield ${selectedDenomination} PRIVX + Get Note`;
      }
    };

    window.copyNote = function() {
      navigator.clipboard.writeText(document.getElementById('noteText').textContent);
      alert("Note copied!");
    };

    // Withdraw: Generate real Plonk proof in browser
    window.withdraw = async function() {
      if (!userAccount) return alert("Connect wallet");
      const note = document.getElementById('withdrawNote').value.trim();
      if (!note) return alert("Paste your note");
      const recipient = document.getElementById('recipientAddress').value.trim() || userAccount;

      const btn = event.target;
      btn.classList.add('loading');
      btn.textContent = "Generating Proof (30-60s)...";

      try {
        // Parse note â†’ nullifier, secret â†’ build input.json (you'll need Merkle path logic here)
        const input = { /* build from note + fetch Merkle proof from relayer or on-chain tree */ };

        const { proof, publicSignals } = await snarkjs.plonk.fullProve(input, WASM_URL, ZKEY_URL);

        // Format proof for contract (adjust to your verifier ABI)
        const proofFormatted = snarkjs.unstringifyBigInts(proof);

        // Call withdraw on contract
        // const contract = new web3.eth.Contract(ABI, shieldAddress);
        // await contract.methods.withdraw(proofFormatted, publicSignals, recipient).send({from: userAccount});

        alert("Proof generated! Withdrawal ready (on-chain call placeholder)");
      } catch (e) {
        console.error(e);
        alert("Proof generation failed â€“ check console");
      } finally {
        btn.classList.remove('loading');
        btn.textContent = "Generate Proof + Withdraw";
      }
    };

    function switchTab(tab) {
      document.getElementById('depositTab').classList.toggle('hidden', tab !== 'deposit');
      document.getElementById('withdrawTab').classList.toggle('hidden', tab !== 'withdraw');
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`.tab[onclick="switchTab('${tab}')"]`).classList.add('active');
    }

    // Matrix rain + other scripts unchanged (keep them below)
  </script>

  <!-- Keep your matrix, burn tracker, etc. scripts here unchanged -->
  <script>
    /* Your matrix rain code */
  </script>
  <script>
    /* Your burn tracker code */
  </script>
</body>
</html>
